<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0" />
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
		<title>Constest - Controle de Eventos de Submissão</title>
		<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons" />
		<!-- CSS  -->
		<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet" />
		<link th:href="@{/webjars/materialize/0.97.6/dist/css/materialize.min.css}" type="text/css" rel="stylesheet" media="screen,projection" />
		<link th:href="@{/webjars/font-awesome/4.6.3/css/font-awesome.min.css}" type="text/css" rel="stylesheet" />
		<link th:href="@{/css/style.css}" type="text/css" rel="stylesheet" media="screen,projection" />
</head>
<body>
  <div th:include="fragments/header :: header"></div>
  <div class="container page">
    <div th:include="fragments/admin_menu_navegacao :: admin_menu_navegacao"></div>
    <div class="row">
      <h2 class="col s12">Adicionar Evento</h2>
    </div>
    <form class="row" action="#" th:action="@{/evento/adicionar}" th:object="${evento}" method="post">
      <input type="hidden" th:field="*{id}" />
      <div class="error_area col s12" th:if="${#fields.hasErrors('*')}">
        <div class="chip row red left" th:each="err : ${#fields.errors('*')}">
          <span class="white-text" th:text="${err}"></span>
          <i class="material-icons">close</i>
        </div>
      </div>
      <div class="input-field col m6 s6">
        <input id="nome_evento" type="text" th:field="*{nome}" />
        <label for="nome_evento">Nome do Evento</label>
      </div>
      <div class="input-field col m6 s6">
        <select id="pessoas_select" name="organizador">
          <option value="" disabled="disabled" selected="selected" >Selecione uma pessoa</option>
          <div th:each="pessoa : ${pessoas}"  >
            <option th:if="${pessoa.id == idPessoa}" th:value="${pessoa.id}" th:text="${pessoa.nome}" selected="selected"></option>
            <option th:if="${pessoa.id != idPessoa}" th:value="${pessoa.id}" th:text="${pessoa.nome}" ></option>   
          </div> 
        </select> 
        <label for="pessoas_select">Organizador do Evento</label>
      </div>
      <div class="input-field col s12">
        <textarea id="descricao" th:field="*{descricao}"  class="materialize-textarea" length="255" maxlength="255"></textarea> 
        <label for="descricao">Descrição</label>
      </div>
      <div class="input-field col s12">
        <button type="submit" class="waves-effect waves-light btn white-text">
          Salvar Evento<i aria-hidden="true" class="fa fa-floppy-o left"></i>
        </button>
      </div>
    </form>
  </div>
  <div th:include="fragments/footer :: footer"></div>
  <script type="text/javascript">
    $(document).ready(function() {
      //Inicialização dos elementos no JS
      //Parallax BG
      $('.parallax').parallax();

      //sideNav
      $(".button-collapse").sideNav();

      //Tooltips
      $('.tooltipped').tooltip({
      	delay : 50
      });

      //select_initializer
      $('select').material_select();

      //datepicker
      $('.datepicker').pickadate({
        selectMonths : true, // Creates a dropdown to control month
        selectYears : 15, // Creates a dropdown of 15 years to control year
        //Persnonalizando nomes dos meses do ano
        monthsFull : [ 'Janeiro',
        'Fevereiro', 'Março',
        'Abril', 'Maio', 'Junho',
        'Julho', 'Agosto',
        'Setembro', 'Outubro',
        'Novembro', 'Dezembro' ],
        //Persnonalizando nomes dos dias da semana
        weekdaysFull : [ 'Domingo',
        'Segunda', 'Terça',
        'Quarta', 'Quinta',
        'Sexta', 'Sábado' ],
        weekdaysShort : [ 'Dom', 'Seg',
        'Ter', 'Qua', 'Qui', 'Sex',
        'Sab' ],
        weekdaysLetter : [ 'D', 'S', 'T',
        'Q', 'Q', 'S', 'S' ],
        today : 'Hoje',
        clear : 'Limpar',
        close : 'Fechar'
      });

      //Trata as datas na tela org_editar_eventos 
      var calendarioSubmissaoInicial = "#prazo_submissao_inicial";
      var calendarioSubmissaoFinal = "#prazo_submissao_final";
      var calendarioRevisaoInicial = "#prazo_revisao_inicial";
      var calendarioRevisaoFinal = "#prazo_revisao_final";

      function habilitarCalendario(calendario) {
        $(calendario).removeAttr("disabled");
      }

      function desabilitarCalendario(calendario) {
        $(calendario).attr("disabled", true);
        $(calendario).pickadate("clear");
      }

      function definirDataMinimaCalendario(calendario, dataMin) {
        var picker = getPicker(calendario);
        picker.set("min", dataMin);
      }

      function getPicker(idCalendario) {
        var $input = $(idCalendario).pickadate();
        var picker = $input.pickadate("picker");
        return picker;
      }

      function configurarCalendario(idCalendarioInicial, idCalendarioFinal) {
        var picker = getPicker(idCalendarioInicial);
        var dataAtual = picker.get();
        var umDia = 1;

        var dataMinima = new Date(dataAtual);
        dataMinima.setDate(dataMinima.getDate() + umDia);

        if (dataAtual.length == 0) {
          desabilitarCalendario(idCalendarioFinal);
        } else {
          habilitarCalendario(idCalendarioFinal);

          definirDataMinimaCalendario(idCalendarioFinal, dataMinima);
        }
      }

      $(calendarioSubmissaoInicial).on("change", function() {
        configurarCalendario(calendarioSubmissaoInicial, calendarioSubmissaoFinal);
      });

      $(calendarioSubmissaoFinal).on("change", function() {
         configurarCalendario(calendarioSubmissaoFinal, calendarioRevisaoInicial);
      });

      $(calendarioRevisaoInicial).on("change", function() {
         configurarCalendario(calendarioRevisaoInicial, calendarioRevisaoFinal);
      });

      //Inicialização do Modal excluir Evento
      $('.modal-trigger').leanModal();
    });
  </script>
</body>
</html>