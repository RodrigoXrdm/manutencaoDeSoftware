<!DOCTYPE html>
<html>
<head>
	<div th:include="fragments/head :: head"></div>
	<link th:href="@{/css/time-line-style.css}" type="text/css" rel="stylesheet" media="screen,projection" />
</head>
<body>
	<div th:include="fragments/header :: header"></div>
	<div class="container page">
		<div th:include="fragments/autor_menu_navegacao :: autor_menu_navegacao"></div>
		<div>
			<div th:if="${eventoVazioError}" id="error_area" class="row chip red white-text" style="margin-right: 5px;margin-left: 5px;" th:text="#{ID_EVENTO_VAZIO_ERROR}">
				<i class="material-icons">close</i>
			</div>
			
			<div th:if="${eventoInexistenteError}" id="error_area" class="row chip red white-text" style="margin-right: 5px;margin-left: 5px;" th:text="#{EVENTO_NAO_EXISTE}">
				<i class="material-icons">close</i>
			</div>
			
			<div th:if="${participarEventoInativoError}" id="error_area" class="row chip red white-text" style="margin-right: 5px;margin-left: 5px;" th:text="#{PARTICIPAR_EVENTO_INATIVO}">
				<i class="material-icons">close</i>
			</div>
			
			<div th:if="${particapacaoEventoSucesso}" id="success_area" class="row chip green white-text" style="margin-right: 5px;margin-left: 5px;" th:text="#{PARTICAPAR_EVENTO_SUCESSO}">
				"M<i class="material-icons">close</i>
			</div>
			
		</div>
		<div class="row">
			<div class="col s12">
				<div class="input-field row">
					<input placeholder="Procurando um evento especifico?"
						id="first_name" type="text" class="col s11 validate" /><a
						class="btn-floating btn-large waves-effect waves-light right">
						<i class="material-icons">search</i>
					</a>
				</div>
			</div>
		</div>

		<div class="col s12" th:if="${!#lists.isEmpty(eventosParaParticipar)}">
			
			<div class="col s12 m7" th:each="evento : ${eventosParaParticipar}">
				<div class="card horizontal">
					<div class="card-stacked">
						<div th:include="fragments/evento_timeline::evento-timeline(evento=${evento})"></div>
						<div class="card-action" >
							<a th:if="${evento.isPeriodoInicial()}"
								th:attr="href='#modal' + ${evento.id}"
								class="btn white-text waves-effect waves-light confirmar modal-trigger">Participar</a>
							<a th:unless="${evento.isPeriodoInicial()}"
								class="btn disabled white-text grey">Período de inscrição encerrado</a>
						</div>
					</div>
				</div>

				<div th:attr="id='modal' + ${evento.id}" class="modal">
					<div class="modal-content">
						<h4>Participar do Evento</h4>
						<h5 th:text="${evento.nome}"></h5>
						<p>Tem certeza que quer participar deste evento?</p>
					</div>
					<form th:action="@{/autor/participarEvento}" method="post">
						
						<div class="modal-footer">
							<input type="hidden" name="idEvento" th:value="${evento.id}"/>
							<button type="submit" class="modal-action modal-close waves-effect btn-flat">Confirmar</button><a
							href="#" class="modal-action modal-close waves-effect btn-flat">Cancelar</a>
						</div>
					</form>
				</div>
			</div>
		</div>
		<div class="col s12 m7" th:if="${!#lists.isEmpty(eventoParticipando)}">
			<div class="card horizontal" th:each="evento : ${eventoParticipando}">
				<div class="card-stacked">
					<div th:include="fragments/evento_timeline::evento-timeline(evento=${evento})"></div>
					<div class="card-action">
						<a class="purple-text">Participando</a>
					</div>
				</div>
			</div>
		</div>
		<div class="row col s12 center">
			<ul class="pagination">
				<li class="disabled"><a href="#"><i class="material-icons">chevron_left</i></a></li>
				<li class="active"><a href="#">1</a></li>
				<li class="waves-effect"><a href="#">2</a></li>
				<li class="waves-effect"><a href="#"><i
						class="material-icons">chevron_right</i></a></li>
			</ul>
		</div>
	</div>
	<!-- footer -->
	<div th:include="fragments/footer :: footer"></div>
	<script type="text/javascript" th:src="@{/js/modernizr.js}"></script>
    <script type="text/javascript" th:src="@{/js/timeline.main.js}"></script>
    <script type="text/javascript">
		$(document)
				.ready(
						function() {
							//Inicialização dos elementos no JS
							//Parallax BG
							$('.parallax').parallax();

							//sideNav
							$(".button-collapse").sideNav();

							//Tooltips
							$('.tooltipped').tooltip({
								delay : 50
							});

							//select_initializer
							$('select').material_select();

							//datepicker
							$('.datepicker').pickadate(
									{
										selectMonths : true, // Creates a dropdown to control month
										selectYears : 15, // Creates a dropdown of 15 years to control year
										//Persnonalizando nomes dos meses do ano
										monthsFull : [ 'Janeiro', 'Fevereiro',
												'Março', 'Abril', 'Maio',
												'Junho', 'Julho', 'Agosto',
												'Setembro', 'Outubro',
												'Novembro', 'Dezembro' ],
										//Persnonalizando nomes dos dias da semana
										weekdaysFull : [ 'Domingo', 'Segunda',
												'Terça', 'Quarta', 'Quinta',
												'Sexta', 'Sábado' ],
										weekdaysShort : [ 'Dom', 'Seg', 'Ter',
												'Qua', 'Qui', 'Sex', 'Sab' ],
										weekdaysLetter : [ 'D', 'S', 'T', 'Q',
												'Q', 'S', 'S' ],
										today : 'Hoje',
										clear : 'Limpar',
										close : 'Fechar'
									});

							//Trata as datas na tela org_editar_eventos 
							var calendarioSubmissaoInicial = "#prazo_submissao_inicial";
							var calendarioSubmissaoFinal = "#prazo_submissao_final";
							var calendarioRevisaoInicial = "#prazo_revisao_inicial";
							var calendarioRevisaoFinal = "#prazo_revisao_final";

							function habilitarCalendario(calendario) {
								$(calendario).removeAttr("disabled");
							}

							function desabilitarCalendario(calendario) {
								$(calendario).attr("disabled", true);
								$(calendario).pickadate("clear");
							}

							function definirDataMinimaCalendario(calendario,
									dataMin) {
								var picker = getPicker(calendario);
								picker.set("min", dataMin);
							}

							function getPicker(idCalendario) {
								var $input = $(idCalendario).pickadate();
								var picker = $input.pickadate("picker");
								return picker;
							}

							function configurarCalendario(idCalendarioInicial,
									idCalendarioFinal) {
								var picker = getPicker(idCalendarioInicial);
								var dataAtual = picker.get();
								var umDia = 1;

								var dataMinima = new Date(dataAtual);
								dataMinima
										.setDate(dataMinima.getDate() + umDia);

								if (dataAtual.length == 0) {
									desabilitarCalendario(idCalendarioFinal);
								} else {
									habilitarCalendario(idCalendarioFinal);

									definirDataMinimaCalendario(
											idCalendarioFinal, dataMinima);
								}
							}

							$(calendarioSubmissaoInicial).on(
									"change",
									function() {
										configurarCalendario(
												calendarioSubmissaoInicial,
												calendarioSubmissaoFinal);
									});

							$(calendarioSubmissaoFinal).on(
									"change",
									function() {
										configurarCalendario(
												calendarioSubmissaoFinal,
												calendarioRevisaoInicial);
									});

							$(calendarioRevisaoInicial).on(
									"change",
									function() {
										configurarCalendario(
												calendarioRevisaoInicial,
												calendarioRevisaoFinal);
									});

							//Inicialização do Modal excluir Evento
							$('.modal-trigger').leanModal();

						});
	</script>
</body>
</html>